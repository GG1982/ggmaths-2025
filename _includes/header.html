<!-- ===== GG Maths Header with Separate Desktop/Mobile Navs ===== -->
<header class="main-header">
  <div class="container">
    <a href="{{ '/' | relative_url }}" class="logo">GG Maths</a>

    <!-- Mobile hamburger -->
    <button class="nav-toggle" aria-label="Toggle menu" aria-expanded="false" aria-controls="nav-mobile">â˜°</button>

    <!-- DESKTOP NAV (unchanged dropdowns) -->
    <nav id="nav-desktop" class="main-nav-desktop" aria-label="Primary (desktop)">
      <ul class="nav-list">
        <li class="dropdown">
          <a href="#" class="dropdown-toggle">Tutoring</a>
          <ul class="dropdown-menu">
            <li><a href="{{ '/primary.html' | relative_url }}">Primary</a></li>
            <li><a href="{{ '/gcse.html' | relative_url }}">Secondary</a></li>
            <li><a href="{{ '/alevel.html' | relative_url }}">A-Level</a></li>
          </ul>
        </li>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle">Info</a>
          <ul class="dropdown-menu">
            <li><a href="{{ '/faq.html' | relative_url }}">FAQ</a></li>
            <li><a href="{{ '/tutors.html' | relative_url }}">Team</a></li>
          </ul>
        </li>
        <li><a href="{{ '/success-stories.html' | relative_url }}">Student Voices</a></li>
        <li><a href="{{ '/about.html' | relative_url }}">About</a></li>
        <li><a href="{{ '/pricing.html' | relative_url }}">Pricing</a></li>
        <li><a href="{{ '/contact.html' | relative_url }}">Contact</a></li>
      </ul>
    </nav>

    <!-- MOBILE NAV (flat list, no dropdowns) -->
    <nav id="nav-mobile" class="main-nav-mobile" aria-label="Primary (mobile)" tabindex="-1">
      <ul class="mobile-list">
        <li><a href="{{ '/primary.html' | relative_url }}">Primary</a></li>
        <li><a href="{{ '/gcse.html' | relative_url }}">Secondary</a></li>
        <li><a href="{{ '/alevel.html' | relative_url }}">A-Level</a></li>
        <li><a href="{{ '/faq.html' | relative_url }}">FAQ</a></li>
        <li><a href="{{ '/tutors.html' | relative_url }}">Team</a></li>
        <li><a href="{{ '/success-stories.html' | relative_url }}">Student Voices</a></li>
        <li><a href="{{ '/about.html' | relative_url }}">About</a></li>
        <li><a href="{{ '/pricing.html' | relative_url }}">Pricing</a></li>
        <li><a href="{{ '/contact.html' | relative_url }}">Contact</a></li>
      </ul>
    </nav>
  </div>
</header>



<script>
(function () {
  const btn = document.querySelector('.nav-toggle');
  const mobileNav = document.getElementById('nav-mobile');
  const desktopNav = document.getElementById('nav-desktop');
  if (!btn || !mobileNav) return;

  const setExpanded = (el, val) => el.setAttribute('aria-expanded', String(val));

  // Highlight the actual current page in both navs
  function markActiveLinks() {
    const current = location.pathname.replace(/index\.html?$/i, '/');
    const allLinks = [
      ...document.querySelectorAll('#nav-mobile a[href], #nav-desktop a[href]')
    ];
    allLinks.forEach(a => {
      a.classList.remove('is-active');
      a.removeAttribute('aria-current');

      const href = a.getAttribute('href');
      if (!href || href === '#') return; // skip dropdown toggles

      const linkPath = new URL(a.href, location.origin).pathname.replace(/index\.html?$/i, '/');
      if (linkPath === current) {
        a.classList.add('is-active');
        a.setAttribute('aria-current', 'page');
      }
    });
  }

  markActiveLinks();

  // Toggle open/close (focus the panel, not the first link)
  btn.addEventListener('click', () => {
    const open = mobileNav.classList.toggle('is-open');
    setExpanded(btn, open);
    if (open) {
      mobileNav.focus({ preventScroll: true }); // focus container; no link highlight
    }
  });

  // Close on outside click (mobile only)
  document.addEventListener('click', (e) => {
    if (!window.matchMedia('(max-width: 768px)').matches) return;
    if (mobileNav.classList.contains('is-open') &&
        !mobileNav.contains(e.target) &&
        !btn.contains(e.target)) {
      mobileNav.classList.remove('is-open');
      setExpanded(btn, false);
    }
  });

  // Close on Escape
  document.addEventListener('keydown', (e) => {
    if (e.key === 'Escape') {
      mobileNav.classList.remove('is-open');
      setExpanded(btn, false);
      btn.focus({ preventScroll: true });
    }
  });

  // Close the menu after tapping a link (nice on mobile)
  mobileNav.addEventListener('click', (e) => {
    if (e.target.closest('a[href]')) {
      mobileNav.classList.remove('is-open');
      setExpanded(btn, false);
    }
  });

  // Re-evaluate active link on history changes (if any)
  window.addEventListener('popstate', markActiveLinks);
})();
</script>
